// main.cpp 
// nouri amirhosein 2025 mar 24 


#include <iostream>
#include <filesystem>
#include "scanner.h"
#include "hash_analyzer.h"
#include "behavior_analyzer.h"
#include "database.h"
#include "reporter.h"


namespace fs = std::filesystem;

int main() {
    std::string path;
    std::cout << "Enter directory path to scan: ";
    std::cin >> path;
    
    // Initialize database
    MalwareDatabase db;
    if (!db.initialize()) {
        std::cerr << "Failed to initialize malware database!" << std::endl;
        return 1;
    }

    // Scan files
    Scanner scanner(path);
    auto files = scanner.scanFiles();
    
    // Analyze each file
    for (const auto& file : files) {
        ScanResult result;
        result.filePath = file;
        
        // Hash analysis
        result.hash = HashAnalyzer::calculateSHA256(file);
        result.isMalware = db.isMalware(result.hash);
        
        // Behavior analysis (Linux-specific)
        result.suspiciousBehaviors = BehaviorAnalyzer::analyze(file);
        
        // Generate report
        Reporter::generateReport(result);
    }
    
    return 0;
}