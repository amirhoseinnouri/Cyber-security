// reporter.cpp
#include "reporter.h"
#include <iostream>
#include <fstream>
#include <ctime>

void Reporter::generateReport(const ScanResult& result) {
    std::ofstream reportFile("scan_report.txt", std::ios::app);
    
    std::time_t now = std::time(nullptr);
    reportFile << "Scan date: " << std::ctime(&now);
    reportFile << "File: " << result.filePath << "\n";
    reportFile << "SHA-256 hash: " << result.hash << "\n";
    reportFile << "Status: " << (result.isMalware ? "Malicious" : "Clean") << "\n";
    
    if (!result.suspiciousBehaviors.empty()) {
        reportFile << "Suspicious behaviors:\n";
        for (const auto& behavior : result.suspiciousBehaviors) {
            reportFile << "- " << behavior << "\n";
        }
    }
    
    reportFile << "------------------------\n";
}